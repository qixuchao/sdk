!function(){"use strict";function c(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function o(t,n){for(var e=0;e<n.length;e++){var o=n[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function e(t,n,e){return n&&o(t.prototype,n),e&&o(t,e),t}function u(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function i(n,t){var e,o=Object.keys(n);return Object.getOwnPropertySymbols&&(e=Object.getOwnPropertySymbols(n),t&&(e=e.filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})),o.push.apply(o,e)),o}function r(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?i(Object(e),!0).forEach(function(t){u(n,t,e[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):i(Object(e)).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))})}return n}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function s(t,n){return(s=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function t(r){var s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var t,n,e,o,i=a(r);return n=s?(t=a(this).constructor,Reflect.construct(i,arguments,t)):i.apply(this,arguments),e=this,!(o=n)||"object"!=typeof o&&"function"!=typeof o?l(e):o}}function d(t){return void 0===t}function h(t){return"function"==typeof t}var f="M$P_M_C",g="M$P_UID",p=Object.prototype.toString;function m(t){if("[object Object]"===(null==(n=t)?void 0===n?"[object Undefined]":"[object Null]":p.call(n))){var n;if(null===Object.getPrototypeOf(t))return 1;for(var e=t;null!==Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}}function v(t,n,e){var o=document.getElementsByTagName("script")[0],i=document.createElement("script");i.onload=function(){i=i.onload=null,n&&n()},i.onerror=function(){i=i.onerror=null,e&&e()},i.src=t,o.parentNode.insertBefore(i,o)}function n(t,n,e){var o=0<arguments.length&&void 0!==t?t:document.body,i=1<arguments.length&&void 0!==n?n:"div",r=2<arguments.length?e:void 0,s=document.createElement(i);return s.id=r,s.style.display="none",s.className=r,o.appendChild(s),s}function y(t,n){if(t)if(Array.isArray(t)||(i=t)&&void 0!==i.length)for(var e=0;e<t.length&&(!n||!1!==n(t[e],e));e++);else if(m(t))for(var o in t)if(n&&!1===n(t[o],o))break;var i}function w(t,n){return Math.floor(t+Math.random()*n)}function b(){return Math.random().toString(36).toUpperCase()}function T(t,n,e){var o=0<arguments.length&&void 0!==t?t:"",i=1<arguments.length&&void 0!==n?n:{REQUESTID:""},r=!(2<arguments.length&&void 0!==e)||e,s={OS:S?1:D?2:"0",APP:window.location.hostname,CLIENTTYPE:3,IP:"",TS:+new Date,IMEI:function(){var t="";try{t=window.localStorage.getItem(g)}catch(t){}return t||(t="H".concat(Math.floor(new Date/1e4),"-").concat(b().slice(-6),"-").concat(b().slice(-6),"-").concat(b().slice(-4)),window.localStorage.setItem(g,t)),t}()};return o.replace(/__(.*?)__/g,function(t){var n,e=t.match(/__(.*)__/),o=s[e[1]]||i[e[1]];return void 0===o?"":((m(n=o)||Array.isArray(n))&&(n=JSON.stringify(n)),r?encodeURIComponent(n):n)})}function k(t){var n,e,o=[];for(var i in t)!d(t[i])&&(n=t,e=i,Object.prototype.hasOwnProperty.call(n,e))&&o.push(i+"="+encodeURIComponent(t[i]));return o.join("&")}function I(t,n){var e,o=/\?([^#]*)/,i=/#(.*)/,r={},s=(t=t||"").match(o);return s&&(r=function(t,n){var e,o,i={};if(!(t||"").replace(/^\s+|\s+$/,""))return{};if(t=t.replace(/\S*\?/,""))for(var r in n&&(t=t.toLocaleLowerCase()),e=t.split("&"))i[(o=e[r].split("="))[0]]=decodeURIComponent(o[1]);return i}(s[0])),r=function(){var t,n,e=arguments,o=1,i=e.length,r=e[0];for(1===i&&(o=0,r=this);o<i;o++)if(t=e[o])for(n in t)r[n]=t[n];return r}.call(r,r,n),e="?"+k(r),o.test(t)?t=t.replace(o,e):i.test(t)?t=t.replace(i,e+"#"+t.match(i)[1]):t+=e,t}function O(t,n){h(n)&&(n={callback:n});var e,o,i=n.callbackFnName||(e="",o=(o="jsonp")||"",(e=e||"")+"_"+Math.random().toString(36).slice(-6)+"_"+o);n=n||{},window[i]=function(t){n.callback&&n.callback(t||{});try{delete window[i]}catch(t){}window[i]=void 0};var r=n.data||{};r.v=Math.random().toString(36).slice(-6),r.jsonp=i,v(I(t,r))}var C=window.navigator.userAgent,S=(/(iPhone|iPod|Android|ios|mobile)/i.test(C),/Android|Linux/.test(C)),D=/\(i[^;]+;( U;)? CPU.+Mac OS X/gi.test(C),_=/MicroMessenger/i.test(C),M=/qq/i.test(C),A=/mqqbrowseer/i.test(C),E=_||M||A,P=/(localhost|127\.0\.0\.1|([192,10]\.168\.\d{1,3}\.\d{1,3}))/.test(window.location.hostname)||/_mp_debug_/.test(window.location.search),j=function(){function t(){c(this,t),this._events={}}return e(t,[{key:"on",value:function(t,n){return(this._events[t]=this._events[t]||[]).push(n),this}},{key:"off",value:function(){}},{key:"once",value:function(t){this.on(t,function(){})}},{key:"trigger",value:function(t,n){var e=this;y(this._events[t],function(t){h(t)&&t.call(e,n)})}}]),t}();function N(t){return R=R||new V(t)}var L,q,R,G,x=function(t,i){"string"==typeof t&&(t=[t]),y(t,function(t){return e=i,void(""!==(n=t)&&((o=new Image).onload=function(){o=o.onload=null},o.src=T(n,e)));var n,e,o})},$=function(){if(P)for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e]},V=function(){function n(t){var o=this;c(this,n),u(this,"proxyComplete",function(e){return function(t){var n=o.slotMap[e];n&&1===n.status&&(Array.isArray(t)?(window.TencentGDT.NATIVE.renderAd(t[0],n.container),n.complete(!0)):n.complete(!1))}}),u(this,"initSlot",function(t){window.TencentGDT.push({placement_id:t.consumerSlotId,app_id:t.appid,type:"native",count:1,onComplete:o.proxyComplete(t.consumerSlotId)})}),window.TencentGDT=window.TencentGDT||[],this.config=t,this.slotMap={},this.init()}return e(n,[{key:"init",value:function(){var n=this;window.M$P_M_C&&window.M$P_M_C.slotBiddings&&(y(window.M$P_M_C.slotBiddings,function(t){y(t.slotBidding,function(t){"gdt"===t.consumer.consumerType&&(n.slotMap[t.consumer.consumerSlotId]={consumerSlotId:t.consumer.consumerSlotId,appid:n.config.gdtAppId,status:0})})}),y(this.slotMap,this.initSlot))}},{key:"bindSlot",value:function(t,n,e){var o=this.slotMap[t];o&&(o.status=1,o.container=n,o.complete=e,window.jsInited&&this.loadAd(t))}},{key:"bindEvent",value:function(e){var o;L||(L=TencentGDT.TN.doClick,q=TencentGDT.TN.adClose,o=function(t){var n=document.querySelector('div[id*="'+t+'"]');return e.unionInstances[n.parentNode.id]},TencentGDT.TN.doClick=function(t,n){var e=o(n);e&&(e.onClick(),L.apply(this,arguments))},TencentGDT.TN.adClose=function(t,n){var e=o(t.traceid);e&&(e.onClose(),q.apply(this,arguments))})}},{key:"loadAd",value:function(t){window.TencentGDT.NATIVE&&window.TencentGDT.NATIVE.loadAd(t)}}]),n}(),B=5e3,U={1e4:"广告数组为空",10001:"js加载失败",10002:"获取广告超时",10003:"广告异常",10004:"广告容器不存在",10005:"非广告渲染环境",2e4:"广点通重复加载广告失败"},H={bid:"bidTracking",error:"errorTracking",imp:"impTracking",bidSuc:"bidSucTracking",click:"clickTracking",winner:"bidSelectedTracking"},z=0,F=function(){!function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&s(t,n)}(a,j);var o=t(a);function a(t,n){var e;return c(this,a),u(l(e=o.call(this)),"onLoaded",function(t){e.log("bidSuc",t),e.adInfo=t,e.trigger("loaded"),e.trigger("complete")}),u(l(e),"onTimeOut",function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"10002";"1"!==e.status&&"11"!==e.status||(e.status="10",e.logError(t),e.trigger("complete"),e.destroy())}),u(l(e),"destroy",function(){e.status="10",e.$container.parentNode&&e.$container.parentNode.removeChild(e.$container)}),e.name=t,e.options=n,e.sandbox=!1!==e.options.sandbox,e}return e(a,null,[{key:"use",value:function(t){if(!d(a.VENDORS[t])&&a.VENDORS[t]instanceof a){var n=a.VENDORS[t].fork();return a.unionInstances[n.id]=n}}}]),e(a,[{key:"getContainer",value:function(t){!1===this.sandbox?this.$container=n(t,"div",this.id):this.$container=n(t,"iframe",this.id)}},{key:"fork",value:function(){var t=new a(this.name,this.options);return t.index=z++,t.id="mp_wrapper_".concat(this.name,"_").concat(t.index),t}},{key:"run",value:function(t,n,e){var o=this,i=0<arguments.length&&void 0!==t?t:{},r=1<arguments.length?n:void 0,s=2<arguments.length?e:void 0;this.getContainer(r),this.data=i,this.config=s;if(this.trigger("init"),o.log("bid"),o.callHook("onInit",i.consumer||{},{onTimeOut:o.onTimeOut,onLoaded:o.onLoaded}),"init"===a.vendorLoaded[this.name]){if(!this.options.src)return this.status="1",a.vendorLoaded[this.name]="loaded",this;a.vendorLoaded[this.name]="loading",v(this.options.src,function(){o.status="1",a.vendorLoaded[o.name]="loaded"},function(){a.vendorLoaded[o.name]="init",o.logError(10001),o.trigger("loadError"),o.trigger("complete")})}else this.status="1";return this}},{key:"logError",value:function(t){var n={DATA:{err:t,errorMessage:U[t]}};this.log("error",n)}},{key:"log",value:function(t,n){var e=1<arguments.length&&void 0!==n?n:{},o={REQUESTID:this.requestId,DATA:r(r(r({},this.requestData),e.DATA),{},{referer:window.location.href}),EXT:e.EXT},i=(this.data.trackingV2Data||this.data.trackingData)[H[t]];x(i,o)}},{key:"render",value:function(t){this.log("winner"),document.querySelector(t)?(this.callHook("onBeforeMount"),this.$container.style.display="block",this.callHook("onMounted"),this.callHook("onShow")):this.logError("10004")}},{key:"callHook",value:function(t){for(var n=this.options[t],e=arguments.length,o=new Array(1<e?e-1:0),i=1;i<e;i++)o[i-1]=arguments[i];return h(n)&&n.apply(this,o)}},{key:"onClick",value:function(){this.log("click")}},{key:"onClose",value:function(){this.trigger("close")}},{key:"reload",value:function(t,n){t===n&&this.destroy(),this.getContainer(document.querySelector(t)),this.status="7"}}]),a}();u(F,"VENDORS",{}),u(F,"unionInstances",{}),u(F,"vendorLoaded",{}),u(F,"register",function(t,n){var e=2<arguments.length&&void 0!==arguments[2]&&arguments[2];(d(F.VENDORS[t])||e)&&(F.VENDORS[t]=new F(t,n),F.vendorLoaded[t]="init")}),(G=F).register("gdt",{src:"//qzs.qq.com/qzone/biz/res/i.js",sandbox:!1,onInit:function(t,n){var e=n.onLoaded,o=n.onTimeOut;if(!E)return this.status="11",o("10005"),void(G.vendorLoaded[this.name]="invalid");var i=setTimeout(function(){o("10002"),clearInterval(i),i=null},B);N(this.config).bindSlot(t.consumerSlotId,this.id,function(t){clearInterval(i),t?e():($("无广告"),o("10000"))})},onBeforeMount:function(){},onMounted:function(){N().bindEvent(G)},onShow:function(){var t,n;window.GDT&&window.GDT.getPosData&&((t=window.GDT.getPosData(this.data.consumer.consumerSlotId))&&t.data&&(n={title:t.data[0].txt,desc:t.data[0].desc,imgList:[t.data[0].img,t.data[0].img2]},this.log("imp",{EXT:n})))},getWeight:function(){},reload:function(t){N().loadAd(t.consumerSlotId)}}),F.register("bd",{src:"//cpro.baidustatic.com/cpro/ui/cm.js",sandbox:!1,onInit:function(t,n){var e,o=this,i=n.onLoaded,r=n.onTimeOut;(window.slotbydup=window.slotbydup||[]).push({id:t.consumerSlotId,container:this.id,async:!0}),e=setTimeout(function(){r("10002"),clearInterval(s),s=null},B);var s=setInterval(function(){o.$container&&o.$container.querySelector("iframe")&&(i(),clearTimeout(e),e=null,clearInterval(s),s=null)},350)},onMounted:function(){},onShow:function(){this.log("imp")}}),F.register("ptgapi",{src:"",sandbox:!1,onInit:function(t,n){var e=this,o=n.onLoaded,i=n.onTimeOut,r=setTimeout(function(){i("10002"),clearTimeout(r),r=null},B),s={ip:"client",mid:209,si:t.consumerSlotId,rr:window.location.href,secure:1,reqid:this.requestId,device_type:1,mimes:"img,c",rsize:"".concat(this.slotSize.width,"*").concat(this.slotSize.height||54),device:JSON.stringify({height:screen.height,width:screen.width,density:2}),v:"1.8.1"},a=[T(this.data.trackingV2Data.clickTracking[0],{DATA:this.requestData,REQUESTID:this.requestId})];O("https://g.fancyapi.com/s2s",{data:s,callback:function(t){var n;clearTimeout(r),Array.isArray(t.ad)&&t.ad.length&&t.ad[0].src?(n=T(t.ad[0].src,{M_PRECLICK:a}),e.$container.innerHTML=n,o()):i("10000")}})},onMounted:function(){},onShow:function(){this.log("imp")}});function W(t){return t&&t.apply(this,Array.prototype.slice.call(arguments,1))}var X=function(t){var o=0;return y(t,function(t){var n=t.weight,e=void 0===n?0:n;o<e&&(o=e)}),o},Q=function(t){var o=[],i=0,n=null;y(t,function(t,n){t.data.weight=t.data.weight&&Math.max(t.data.weight,1),i+=t.data.weight;var e=o[n-1]&&o[n-1].rang[1]||0;o.push({name:t.name,weight:t.data.weight,union:t,rang:[e,e+t.data.weight]})});var e=w(0,i);return y(o,function(t){if(e>=t.rang[0]&&e<t.rang[1])return n=t.union,!1}),n},J=function(){function s(t){var e=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},o=2<arguments.length?arguments[2]:void 0,i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};c(this,s),u(this,"pickConsumer",function(t){var n=e.slotConfig.priorityPolicy;0===n||1===n&&t.data.weight===e.consumerMaxWeight?e.race(t):2===n&&e.loadedConsumers.length===e.consumerLength&&e.race(Q(e.loadedConsumers))}),this.container=t,this.isConcurrent=n.isConcurrent,this.priorityPolicy=n.priorityPolicy,this.slotConfig=n,this.config=o,this.slotOptions=i,this.slotId=n.slotId,this.status="0";var r=document.querySelector(t);this.slotContainerSize={width:r.clientWidth||r.scrollWidth||r.offsetWidth,height:r.clientHeight||r.scrollHeight||r.offsetHeight},this.templateConfig=n.templateConfig||{},this.consumers=n.slotBidding,this.consumerLength=this.consumers&&this.consumers.length,this.consumerMaxWeight=X(this.consumers),this.loadedConsumers=[],this.completeNumber=0,this.loadedConsumerNumber=0,this.distribute()}return e(s,[{key:"distribute",value:function(){var e,i=this;0<this.consumerLength?(e=document.querySelector(this.container),this.loadedConsumers=[],y(this.consumers,function(t){var n=F.use(t.consumer.consumerType);n&&(n.slotSize=i.slotContainerSize,n.requestId="".concat(i.slotId,"-").concat(t.consumer.consumerSlotId,"-").concat((new Date).getTime(),"-").concat(w(0,100)),n.requestData={category:i.isConcurrent,sdkVersion:"1.8.1",policyVersion:i.config.policyVersion,slotId:i.slotId,err:0,consumerType:t.consumer.consumerType,consumerSlotId:t.consumer.consumerSlotId},n.on("init",function(){}).on("loaded",function(){i.loadedConsumers.push(n),"5"!==i.status&&(i.status="4",i.pickConsumer(n))}).on("complete",i.handleComplete.bind(i)).on("close",function(){W(i.slotConfig.onClose)}),n.run(t,e,i.config))}),this.timeouter=setTimeout(function(){var t,e,o;2===i.slotConfig.priorityPolicy?i.race(Q(i.loadedConsumers)):1===i.slotConfig.priorityPolicy&&i.race((t=i.loadedConsumers,e=null,o=0,y(t,function(t,n){t.data.weight>o&&(o=(e=t).data.weight)}),e))},3e3)):W(this.slotOptions.complete,!1)}},{key:"handleComplete",value:function(){++this.completeNumber===this.consumerLength&&"5"!==this.status&&"4"!==this.status&&W(this.slotOptions.complete,!1)}},{key:"race",value:function(t){clearTimeout(this.timeouter),t instanceof F&&("5"!==this.status?(W(this.slotOptions.complete,!0),this.status="5",(this.winner=t).render(this.container)):t.destroy())}},{key:"reload",value:function(t){var n;return this.winner&&(n=this.container,this.container=t,this.winner.reload(this.container,n)),this.distribute(),this.status="7",this}}]),s}(),K=function(){function n(t){c(this,n),u(this,"Ver","1.8.1"),this.slots={},this.init(t)}return e(n,[{key:"init",value:function(t){this._originalList=t,(window.M$P=this).MEDIA_CONFIG={},this.config=window[f].config||{},this.parseMediaConfig(window[f]),this.handler(this._originalList)}},{key:"parseMediaConfig",value:function(t){var n=this,e=0<arguments.length&&void 0!==t?t:{};this.MEDIA_CONFIG={},e.slotBiddings&&y(e.slotBiddings,function(t){n.MEDIA_CONFIG[t.slotId]=n.uniqueConsumer(t)})}},{key:"uniqueConsumer",value:function(t){var e={};return y(t.slotBidding,function(t){var n=t.consumer.consumerType;e[n]||(e[n]=t)}),t.slotBidding=Object.values(e),t}},{key:"push",value:function(t){this.handler([t])}},{key:"handler",value:function(t){var n=this;y(t,function(o){h(o)?o.call(n,{union:{register:F.register,use:F.use},utils:{}}):m(o)&&(d(o.id)?d(o.mediaid)||d(o.secret)||d(n.mediaid)&&(n.mediaid=o.mediaid,n.secret=o.secret):(d(n.slots[o.id])||o.force)&&n.MEDIA_CONFIG[o.id]&&n.fillAd(o.container,r(r({},n.MEDIA_CONFIG[o.id]),{},{id:o.id}),o.force,{complete:function(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];o.complete&&o.complete.apply(this,n),!1===n[0]&&o.fallback&&o.fallback()}}))})}},{key:"fillAd",value:function(t,n,e,o){this.slots[n.id]&&e?this.slots[n.id]=this.slots[n.id].reload(t):this.slots[n.id]=new J(t,n,this.config,o)}}]),n}(),Y=window.M$P;(Array.isArray(Y)||d(Y))&&new K(Y)}();
